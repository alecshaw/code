# Amplitude normalization
# Alec Shaw <alecshaw@hi.is>

# This script normalises amplitude of a selection of sound files

# Clear all existing info
clearinfo

target_dir$ = target$
destination_dir$ = destination$

Create Strings as file list... list 'directory$'/*.wav
numberOfFiles = Get number of strings

for ifile to numberOfFiles
  select Strings list
  filename$ = Get string... ifile
  Read from file... 'directory$'/'filename$'

  filename$ = replace$("'filename$'", ".wav", "",0)

  Convert to mono

  # Scaling average intensity to 70dB
  Scale intensity... 70

  Save as WAV file... 'destination_dir$'/'filename$'.wav

  selectObject: "Sound 'fileName$'"
  plusObject: "Sound 'fileName$'_mono"
  Remove
endfor

select Strings list
Remove
